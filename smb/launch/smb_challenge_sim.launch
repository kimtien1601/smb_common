<?xml version="1.0" encoding="UTF-8"?>
<launch>

  <arg name="sim"                default="true"/>
  <arg name="launch_gazebo_gui"  default="false"/>

  <!-- mpc -->
  <arg name="mpc"
       default="false"
       doc="Launch the MPC node."/>

  <arg name="mpc_track_local_plan"
       default="false"
       doc="Track the plan published from the mpc_path_publisher.py script in smb_mpc package."/>

  <!-- smb_slam arguments -->
  <arg name="map_name"            default="sim.pcd" /> 
  <arg name="pcd_filepath"        default="$(find smb_slam)/maps/$(arg map_name)" />
  <arg name="global_map"         default="$(find smb_navigation)/data/simulation/map.yaml"/>
  
  <!-- smb_navigation arguments -->
  <arg name="use_global_map"     default="true"/>
  <arg name="global_frame"       default="map"/>

    <!-- smb_navigation navigate2d -->
    <arg name="navigate2d"
        default="true"/>
  <!-- relocation publisher change this after measurement-->
  <node pkg="smb_slam" type="relocalize.py" name="relocalize_tf_publisher"></node>
  <!-- <node pkg="tf" type="static_transform_publisher" name="challenge_tf_broadcaster" args="-4.11 8.77 0 0 0 0.68 0.73 map challenge_tf 100" /> -->
  <node pkg="tf" type="static_transform_publisher" name="challenge_tf_broadcaster" args="0 0 0 0 0 0 range_sensor range_sensor_o3d 100" />
  <!-- msf -->
  <include file="$(find open3d_slam_ros)/launch/mapping.launch"></include>
  <include file="$(find smb_msf)/launch/smb_msf.launch">
    <arg name="use_sim_time"                      value="true"/>
    <arg name="imu_topic"                         value="/imu0"/>
    <arg name="pose_topic"                         value="/mapping_node/scan2map_transform"/>
  </include>
  <!-- start smb_gazebo launch -->
  <include file="$(find smb_gazebo)/launch/sim.launch">
    <arg name="mpc"                      value="$(arg mpc)"/>
    <arg name="launch_gazebo_gui"                      value="$(arg launch_gazebo_gui)"/>
  </include>

  <!-- start smb_slam launch -->
  <include file="$(find smb_slam)/launch/localization.launch">
    <arg name="map_name"                      value="$(arg map_name)"/>
    <arg name="pcd_filepath"                  value="$(arg pcd_filepath)"/>
  </include>

  <!-- start smb_navigation navigate2d launch -->
  <group if="$(arg navigate2d)">
    <include file="$(find smb_navigation)/launch/navigate2d.launch">
      <arg name="use_global_map"    value="$(arg use_global_map)"/>
      <arg name="global_frame"      value="$(arg global_frame)"/>
      <arg name="sim"               value="$(arg sim)"/>
      <arg name="global_map"        value="$(arg global_map)"/>
    </include>
  </group>

  <!-- start smb_opc launch -->
  <!-- <include file="$(find smb_opc)/launch/opc.launch">
    <arg name="map_name"                      value="$(arg map_name)"/>
  </include> -->

</launch>
